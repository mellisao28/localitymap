"use strict";function initialize(){var e={zoom:13,center:position,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map_canvas"),e),google.maps.event.addDomListener(document.getElementById("reset"),"click",resetMap),ko.applyBindings(new ViewModel)}function resetMap(){null!=infowindow&&infowindow.close(),map.setCenter(position),map.setZoom(13),map.setMapTypeId(google.maps.MapTypeId.ROADMAP)}var initialMarker=[{id:0,name:"LA Fitness",latitude:33.33716,longitude:-111.877526,category:"yellow"},{id:1,name:"Harkins Theatres",latitude:33.298957,longitude:-111.900029,category:"green"},{id:2,name:"TechShop",latitude:33.299978,longitude:-111.838311,category:"purple"},{id:3,name:"Walmart",latitude:33.337525,longitude:-111.854406,category:"blue"},{id:4,name:"Chandler Center for the Arts",latitude:33.307387,longitude:-111.842455,category:"green"},{id:5,name:"PGA Tour Superstore",latitude:33.336236,longitude:-111.839142,category:"yellow"},{id:6,name:"Ninja Japanese Restaurant",latitude:33.339919,longitude:-111.859536,category:"red"},{id:7,name:"Carl's Jr.",latitude:33.33327,longitude:-111.859487,category:"red"},{id:8,name:"Taco Bell",latitude:33.335453,longitude:-111.859935,category:"red"},{id:9,name:"Subway (restaurant)",latitude:33.31396,longitude:-111.84107,category:"red"},{id:10,name:"Walgreens",latitude:33.334514,longitude:-111.875665,category:"blue"},{id:11,name:"Lee Lee Int'l Supermarket",latitude:33.336151,longitude:-111.874338,category:"blue"}],infowindow,Point=function(e){this.name=e.name,this.id=e.id,this.latitude=e.latitude,this.longitude=e.longitude,this.category=e.category,this.marker=null},map,ViewModel=function(){function e(e,i){s.currentMarker(e),t(i),o(e),n(i,e.name,e.latitude,e.longitude),a(i)}function t(e){var t=e.getPosition();map.panTo(t)}function n(e,t,n,a){var o="",r=[];o="https://api.foursquare.com/v2/venues/search?client_id=2BIWS0KFSP1W12ARXFHNA20WHNGY0NMOAD3AFYM1ZGCFCF32&client_secret=I2F4TTJ0HJOIAO2GCPP0T2NJBMMHFVMCLAQ4HIHF5U1JZCNG&v=20130815&m=foursquare&ll="+n+","+a+"&query="+t+"&intent=match",$.ajaxSetup({error:function(){alert("error")}}),$.ajax({url:o,dataType:"jsonp",success:function(n){if(n.response.venues.length>0){var a=n.response.venues[0];r={lat:a.location.lat,lng:a.location.lng,name:a.name,loc:a.location.address+" "+a.location.city+", "+a.location.state+" "+a.location.postalCode},i(e,r.name,r.loc)}else i(e,t,"")}})}function i(e,t,n){null!=infowindow&&infowindow.close(),infowindow=new google.maps.InfoWindow({content:"<h2>"+t+'</h2><div class="desc">'+n+"</div>"}),infowindow.open(map,e)}function a(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},750)}function o(e){var t=$("#wikipedia");t.text("");var n="http://en.wikipedia.org/w/api.php?action=parse&page="+e.name+"&prop=text&section=0&format=json&callback=?";t.append("<h1>"+e.name+"</h1>"),$.getJSON(n,function(e){if(e.parse)for(var n in e.parse.text){var i=e.parse.text[n].split("<p>"),a="";for(var o in i)if(i[o]=i[o].split("<!--"),i[o].length>1&&(i[o][0]=i[o][0].split(/\r\n|\r|\n/),i[o][0]=i[o][0][0],i[o][0]+="</p> "),i[o]=i[o][0],i[o].lastIndexOf("</p>")==i[o].length-5){var r=i[o].replace(/<(?:.|\n)*?>/gm,""),l=r.split(/\r\n|\r|\n/);for(var s in l)"Cite error:"!=l[s].substring(0,11)&&(a+=l[s],a+="\n")}a=a.substring(0,a.length-2),a=a.replace(/\[\d+\]/g,""),t.append("<div>"+a+"</div>")}else t.append("<div>No available information</div>")})}function r(e,t){null!=infowindow&&infowindow.close(),e.each(function(e){var n=$(this).attr("id");s.markerList()[n].marker.setVisible(t)})}function l(){var e=JSON.parse(this.responseText);$("#weather").append("<div>Today is <b>"+e.main.temp+"</b> Â°F</div>")}var s=this;this.markerList=ko.observableArray(),initialMarker.forEach(function(t){var n=new Point(t),i=new google.maps.LatLng(t.latitude,t.longitude),a=new google.maps.Marker({position:i,title:t.name,map:map,icon:"http://maps.google.com/mapfiles/ms/icons/"+t.category+"-dot.png"});google.maps.event.addListener(a,"click",function(){e(n,a)}),n.marker=a,s.markerList.push(n)}),s.currentMarker=ko.observable(s.markerList()[0]),this.setMarker=function(t){e(t,t.marker)},function(e){function t(t,n){var i=e("<form>").attr({"class":"filterform",action:"#"}),a=e("<input>").attr({"class":"filterinput",type:"text"});e(i).append(a).appendTo(t),e(a).change(function(){var t=e(this).val();if(t){var i=e(n).find(":Contains("+t+")");e("li",n).not(i).slideUp("fast",function(){r(e("li",n).not(i),!1)}),i.slideDown("fast",function(){r(i,!0)})}else e(n).find("li").slideDown("fast",function(){r(e(n).find("li"),!0)});return!1}).keyup(function(){e(this).change()})}jQuery.expr[":"].Contains=function(e,t,n){return(e.textContent||e.innerText||"").toUpperCase().indexOf(n[3].toUpperCase())>=0},e(function(){t(e("#form"),e("#list"))})}(jQuery);var d=function(e){var t="http://api.openweathermap.org/data/2.5/weather?q="+e+"&units=Imperial",n=new XMLHttpRequest;n.addEventListener("load",l),n.open("get",t,!0),n.send()};d("Chandler,AZ, US")},position=new google.maps.LatLng(33.321111,-111.859803);